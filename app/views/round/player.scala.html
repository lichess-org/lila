@(pov: Pov, version: Int, engine: Boolean, bookmarkers: List[String], analysed: Boolean, chat: Option[lila.chat.MixedChat], tour: Option[lila.tournament.Tournament])(implicit ctx: Context)

@import pov._

@title = @{ "Play %s - %s".format(gameId, color) }

@underchat = {
<div class="watchers">
  @trans.spectators() <span class="list inline_userlist"></span>
</div>
}

@round.layout(
title = title,
goodies = views.html.game.infoBox(pov, tour),
chat = chat.map(c => base.chat(c, trans.chatRoom.str())),
underchat = underchat.some,
signedJs = pov.game.rated option routes.Round.signedJs(pov.gameId) map (_.toString)) {
<div class="lichess_game clearfix lichess_player_@color not_spectator"
  data-socket-url="@routes.Round.websocketPlayer(fullId)"
  data-table-url="@routes.Round.tablePlayer(fullId)"
  data-end-url="@routes.Round.endPlayer(fullId)">
  <div class="lichess_board_wrap">
    <div class="lichess_board with_marks">@Html(lila.app.ui.Board.render(pov))</div>
    <div id="premove_alert">@trans.premoveEnabledClickAnywhereToCancel()</div>
  </div>
  <div class="lichess_ground">
    @round.cemetery(pov, "top")
    <div class="lichess_table_wrap">
      @game.clock.map { c =>
      @round.clock(c, !pov.color, "top")
      }
      <div class="lichess_table@{ if(game.hasClock) " table_with_clock" }@{ if(game.finished) " finished" }">
        <div class="lichess_opponent">
          @round.username(pov.opponent, engine)
        </div>
        <div class="lichess_separator"></div>
        <div class="table_inner">
          @game.playable.fold(round.table.playing(pov), round.table.end(pov, tour))
        </div>
      </div>
      @game.clock.map { c =>
      @round.clock(c, pov.color, "bottom")
      @if(game.moretimeable) {
      <a class="moretime" title="@trans.giveNbSeconds(moretimeSeconds)"></a>
      }
      }
    </div>
    @round.cemetery(!pov, "bottom")
  </div>
</div>
@embedJs("var _ld_ = " + roundPlayerJsData(pov, version, ctx.pref))
@analyse.link(pov, analysed)
@if(!tour.fold(false)(_.isRunning)) {
@views.html.game.more(pov, bookmarkers) {
<nav>
@continueFromHere(game)
<a href="@routes.Analyse.replay(gameId, color.name)">@trans.replayAndAnalyse()</a>
@if(game.pgnImport.isEmpty) {
<br />
<a href="@routes.Analyse.stats(gameId)">@trans.viewGameStats()</a>
}
<br />
@fenPgn(game)
</nav>
}
}
}
